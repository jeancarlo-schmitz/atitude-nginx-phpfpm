#!/bin/bash
set -e

echo "ğŸ”» Parando containers..."
docker-compose down

echo "ğŸ§¹ Limpando containers parados..."
docker container prune -f

echo "ğŸ§¹ Removendo imagem antiga do php_backend..."
docker image rm $(docker images | grep docker-ngix-phpfpm_php | awk '{print $3}') || true

echo "ğŸ”¨ Rebuildando apenas o php..."
docker-compose build --no-cache php

echo "ğŸš€ Subindo containers novamente..."
docker-compose up -d

echo "âœ… Containers ativos:"
docker ps